<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>What you don't know is affecting your performance | Flatterline</title>
    <meta name="description" content="">

    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css" />
    <link href="/stylesheets/print.css" media="print" rel="stylesheet" type="text/css" />
    <!--[if IE]>
        <link href="/stylesheets/ie.css" media="screen, projection" rel="stylesheet" type="text/css" />
    <![endif]-->

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  </head>

  <body>
    <div id="wrap_all">
  <div id="wrap_all_2" class="row">
    <header id="page_header" class="span16">
  <div id="page_header_inner_wrap" class="row">
    <div id="page_logo_wrap" class="span12"><h1>Flatterline</h1></div>
    <div class="page-head-contact" class="span4">
      <a href="/contact/" class="success orange btn">Contact</a>
    </div>
  </div>
</header>
    
    <div class="span12">
  <div class="before-content-header">
    <menu>
      <a href="/blog/">Blog</a>
    </menu>
  </div>

  <div id="post">
    <div id="content">
      <p>Does your Linux-based virtualized hosting feel a little slow? Does it suffer from preemptive swapping? Here's a quick tip on getting some more performance out of your current setup.This is especially useful if you have a significant ratio of physical RAM to in-memory programs.</p>

<h2>Swappiness</h2>

<p>The Linux 2.6 kernel has a parameter called vm.swappiness that regulates the kernel's likelihood to swap memory to disk (e.g., to free up memory for disk/content caching, load other programs, etc). Valid values are between 0 and 100. On the current release of Ubuntu (Intrepid) this value has a default value of 60 that you can investigate with the following command:</p>

<pre><code>$ cat /proc/sys/vm/swappiness
60
</code></pre>

<p>This value is generally fine, but if your physical memory is significantly higher than what you need it's worth investigating other choices.I personally find a pretty significant performance increase in Rails behavior with a value of 0; essentially telling the kernel to not swap anything out until it becomes absolutely necessary.</p>

<p>The value can be changed either with:</p>

<pre><code>$ sysctl vm.swappiness=0
</code></pre>

<p><strong>or</strong></p>

<pre><code>$ echo 0 &amp;gt; /proc/sys/vm/swappiness
</code></pre>

<h2>A persistent lack of swappiness</h2>

<p>If you restart the server, then your change will be lost. If you want the change to remain persistent across restarts you'll either need to create a script that calls one of these commands or edit /etc/sysctl.conf to specify the swappiness. As always, exercise caution playing with kernel parameters :-).</p>

<h2>Swapping it back in</h2>

<p>If you change vm.swappiness and want to force the kernel to swap everything back in you can temporarily disable the swap partition and then immediately re-enable it.</p>

<pre><code>$ swapon -s

Filename         Type      Size  Used  Priority
/dev/sda2         partition    524280 33948  -2

$ swapoff /dev/sda2
$ swapon /dev/sda2
</code></pre>

<p>If the machine doesn't have enough memory to accommodate the swap-in the command will fail with an error.</p>

<p><strong>Let us know if this helps you out!</strong></p>

    </div>
  </div>

  <div id="related">
    <h2>Related Posts</h2>
    <ul class="posts">
      
        <li><span>09 Apr 2009</span> &raquo; <a href="/2009/04/09/what-you-dont-know-is-affecting-your-performance">What you don't know is affecting your performance</a></li>
      
        <li><span>27 Apr 2009</span> &raquo; <a href="/2009/04/27/optimizing-hardware-costs-for-amazon-ec2">Optimizing hardware costs for Amazon EC2</a></li>
      
        <li><span>23 Apr 2009</span> &raquo; <a href="/2009/04/23/disposable-proxy-for-secure-coffee-shop-browsing">Disposable proxy for secure coffee shop browsing</a></li>
      
    </ul>
  </div>
  
  <div class="bottom-call-to-action alert-message block-message info">
  Looking for <a href="/" class="shh">web development services</a>?&nbsp;  <a href="/contact/">Contact our developers</a> to get started.
</div>
</div>


<aside id="sidebar" class="span4">
  <h3>Services</h3>
  <ul>
    <li>Web Development</li>
    <li>Ruby on Rails Project Management</li>
    <li>Search Engine Optimization</li>
  </ul>
</aside>
    
    <footer id="page_footer" class="span16">
  <a href="/">Flatterline</a>.
  <a href="/contact/">Contact us</a>.
</footer>
  </div>
</div>
  </body>
</html>
